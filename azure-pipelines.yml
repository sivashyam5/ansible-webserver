# Ansible Azure Pipeline
  trigger:
  - master
  pool:
    name: 'default'

  steps:
  - script: |
      sudo apt-get update -y
      sudo apt install -y ansible
      ansible --version
    displayName: 'Installing Ansible'

  - script: |
      sudo apt-get update -y
      sudo apt-get install -y ansible-lint
      ansible-lint --version
    displayName: 'Installing Ansible-lint'

  - task: Bash@3
    inputs:
      targetType: 'inline'
      script: 'ansible-lint'
      workingDirectory: '$(Build.SourcesDirectory)/playbooks'
    displayName: 'Executable Ansible-lint'

  - script: ANSIBLE_HOST_KEY_CHECKING=False ansible-playbook -u ubuntu -i ./host_inventory ./playbooks/apache-install.yml --private-key '/home/ubuntu/.ssh/vm-instance-key.pem'
    displayName: 'Installing Apache'

    

